function processDataCheckJobs(e){e.forEach(function(e){var a=e.jobRoleId,t=e.jobName,n={};n.id=a,n.name=t,jobArray.push(n)}),NProgress.done()}function processDataCheckLocality(e){e.forEach(function(e){var a=e.localityId,t=e.localityName,n={};n.id=a,n.name=t,localityArray.push(n)}),NProgress.done()}function getLocality(){return localityArray}function getJob(){return jobArray}function recreateDataTable(){NProgress.start(),$.fn.dataTable.isDataTable("table#candidateSearchResultTable")&&$("table#candidateSearchResultTable").DataTable().clear(),renderSearchResult(),NProgress.done()}function getJobPref(e){var a=[];try{e.forEach(function(e){var t=e.jobRole.jobName;a.push(" "+t)})}catch(t){}return a}function getLocalityPref(e){var a=[];try{e.forEach(function(e){var t=e.locality.localityName;a.push(" "+t)})}catch(t){}return a}function getInYearMonthFormat(e){if(null==e)return"NA";var a=Math.round(parseInt(e)/12*100)/100;return a}function getLanguageKnown(e){var a=[];try{if(null==e||e.length<1)return"NA";e.forEach(function(e){a.push(""+e.language.languageName+" ("+e.understanding+", "+e.verbalAbility+", "+e.readWrite+")")})}catch(t){}return a}function getLastWithdrawnSalary(e){return null==e?"NA":e}function getGender(e){return null==e?"NA":"0"==e?"M":"1"==e?"F":void 0}function getEducation(e){return null!=e&&null!=e.education?e.education.educationName:"NA"}function getSkills(e){var a=[];return null!=e&&(e.forEach(function(e){if(null!=e&&null!=e.candidateSkillResponse){var t;t=1==e.candidateSkillResponse?"Yes":"No",a.push(" "+e.skill.skillName+" : "+t)}}),a.length>0)?a:"NA"}function getHomeLocality(e){return null!=e?e.localityName:"NA"}function getDateTime(e){var a=new Date(e).getUTCFullYear()+"-"+("0"+(new Date(e).getUTCMonth()+1)).slice(-2)+"-"+("0"+new Date(e).getDate()).slice(-2)+" "+("0"+new Date(e).getHours()).slice(-2)+":"+("0"+new Date(e).getMinutes()).slice(-2)+":"+("0"+new Date(e).getSeconds()).slice(-2);return a}function getPastOrCurrentCompanyName(e){var a=[];return null!=e&&e.forEach(function(e){if(null!=e&&null!=e.candidatePastCompany){var t=e.currentJob?" *":"";a.push(" "+e.candidatePastCompany+t)}}),a.length>0?a:"NA"}function getYesNo(e){return null!=e?"0"==e||0==e?"No":"yes":"NA"}function getExperience(e){var a=[];return null!=e?(e.forEach(function(e){null!=e&&null!=e.jobExpQuestion&&null!=e.jobExpResponse&&a.push(" "+e.jobExpQuestion.jobRole.jobName+": "+e.jobExpQuestion.expCategory.expCategoryName+": "+e.jobExpResponse.jobExpResponseOption.jobExpResponseOptionName)}),a):"NA"}function getAge(e){var a=Date.now()-e,t=new Date(a);return Math.abs(t.getUTCFullYear()-1970)}function getProperProfileStatus(e){return null!=e?"1"==e.profileStatusId?"Active":e.profileStatusName:"NA"}function getExpiry(e){return null!=e?e.statusExpiryDate:"NA"}function getLastName(e){return null!=e?e:"NA"}function getFirstName(e){return null!=e?e:"NA"}function getIdProof(e){var a=[];return null!=e&&(e.forEach(function(e){null!=e&&null!=e.idProof&&null!=e.idProof.idProofName&&a.push(" "+e.idProof.idProofName)}),a.length>0)?a:"NA"}function renderSearchResult(e){var a=e.status,t=e.candidateList;if(3==a)$("#searchErrorMsg").text("Looks like you have exhausted your search limit. Please contact your administrator."),$("#searchError").show(),$("#candidateSearchResultTable").hide();else{$("#searchError").hide();var n=[];try{t.forEach(function(e){var a="",t="";null!=e.timeShiftPreference&&(a=e.timeShiftPreference.timeShift.timeShiftName),null!=e.locality&&(t=e.locality.localityName),n.push({cLID:'<a href="/candidateSignupSupport/'+e.lead.leadId+'/false" target="_blank">'+e.lead.leadId+"</a>",candidateFirstName:getFirstName(e.candidateFirstName)+" "+getLastName(e.candidateLastName),candidateMobile:e.candidateMobile,candidateLastWithdrawnSalary:getLastWithdrawnSalary(e.candidateLastWithdrawnSalary),candidateJobPref:getJobPref(e.jobPreferencesList),candidateLocalityPref:getLocalityPref(e.localityPreferenceList),locality:getHomeLocality(e.locality),candidateLanguage:getLanguageKnown(e.languageKnownList),candidateEducation:getEducation(e.candidateEducation),candidateSkillList:getSkills(e.candidateSkillList),candidateTimeShiftPref:a,candidateExperience:getInYearMonthFormat(e.candidateTotalExperience),candidateIsAssessmentComplete:getYesNo(e.candidateIsAssessed),candidateGender:getGender(e.candidateGender),candidateIsEmployed:getYesNo(e.candidateIsEmployed),candidateCreateTimestamp:getDateTime(e.candidateCreateTimestamp),pastOrCurrentCompanyName:getPastOrCurrentCompanyName(e.jobHistoryList),isMinProfileComplete:getYesNo(e.isMinProfileComplete),followUp:getYesNo(e.lead.followUp),noOfJobApplication:e.jobApplicationList.length,experience:getExperience(e.candidateExpList),age:getAge(e.candidateDOB),candidateExperienceLetter:getYesNo(e.candidateExperienceLetter),isActive:getProperProfileStatus(e.candidateprofilestatus),candidateExpiry:getExpiry(e.candidateStatusDetail),candidateIdProofs:getIdProof(e.idProofReferenceList)})}),$("#candidateSearchResultTable").show();var i=$("table#candidateSearchResultTable").DataTable({data:n,order:[[15,"desc"]],scrollX:!0,columns:[{data:"cLID"},{data:"candidateFirstName"},{data:"candidateMobile"},{data:"candidateJobPref"},{data:"candidateLocalityPref"},{data:"locality"},{data:"candidateExperience"},{data:"candidateIsEmployed"},{data:"candidateLastWithdrawnSalary"},{data:"candidateLanguage"},{data:"candidateEducation"},{data:"candidateSkillList"},{data:"candidateGender"},{data:"candidateIsAssessmentComplete"},{data:"candidateTimeShiftPref"},{data:"candidateCreateTimestamp"},{data:"pastOrCurrentCompanyName"},{data:"isMinProfileComplete"},{data:"followUp"},{data:"noOfJobApplication"},{data:"experience"},{data:"age"},{data:"candidateExperienceLetter"},{data:"isActive"},{data:"candidateExpiry"},{data:"candidateIdProofs"}],deferRender:!0,scroller:!0,scrollY:"48vh",scrollCollapse:!0,language:{emptyTable:"No data available"},destroy:!0,dom:"Bfrtip",buttons:["copy","csv","excel"]});i.columns().every(function(){var e=this;$("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})}),$.fn.dataTable.moment("dd/MM/YYYY HH:mm:ss");var r=$("#candidateSearchResultTable").dataTable();$("#minExp").keyup(function(){r.fnDraw()}),$("#maxExp").keyup(function(){r.fnDraw()}),$("#minSal").keyup(function(){r.fnDraw()}),$("#maxSal").keyup(function(){r.fnDraw()}),$("#minJobApplication").keyup(function(){r.fnDraw()}),$("#maxJobApplication").keyup(function(){r.fnDraw()}),$("#minAge").keyup(function(){r.fnDraw()}),$("#maxAge").keyup(function(){r.fnDraw()})}catch(o){void 0}}NProgress.done()}function searchForm(){var e,a=[],t=[],n=$("#candidateJobPref").val().split(","),i=$("#candidateLocalityPref").val().split(",");for(e=0;e<n.length;e++)t.push(n[e]);for(e=0;e<i.length;e++)a.push(i[e]);var r={candidateFirstName:$("#candidateFirstName").val(),candidateMobile:$("#candidateMobile").val(),candidateLocality:a,candidateJobInterest:t,fromThisDate:$("#fromThisDate").val(),toThisDate:$("#toThisDate").val(),languageKnown:$("#languageMultiSelect").val()};if(r.fromThisDate>r.toThisDate)$.notify({title:"Invalid Date Input: ",message:"Selected Date Range is Incorrect. Please Select valid (from/to) Date",animate:{enter:"animated lightSpeedIn",exit:"animated lightSpeedOut"}},{type:"danger"}),void 0,shouldAddFooter=!1;else{shouldAddFooter=!0,NProgress.start();try{$.ajax({type:"POST",url:"/getSearchCandidateResult",contentType:"application/json; charset=utf-8",data:JSON.stringify(r),success:renderSearchResult})}catch(o){void 0}}}function processLanguage(e){if(null!=e){var a=[];e.forEach(function(e){var t={label:e.languageName,value:parseInt(e.languageId)};a.push(t)});var t=$("#languageMultiSelect");t.multiselect({includeSelectAllOption:!0,maxHeight:300}),t.multiselect("dataprovider",a),t.multiselect("rebuild")}}var localityArray=[],jobArray=[],shouldAddFooter=!0;$.fn.dataTableExt.afnFiltering.push(function(e,a,t){var n=1*document.getElementById("minExp").value,i=1*document.getElementById("maxExp").value,r="-"==a[6]?0:1*a[6];return""==n&&""==i||(""==n&&r<=i||(n<=r&&""==i||n<=r&&r<=i))},function(e,a,t){var n=1*document.getElementById("minSal").value,i=1*document.getElementById("maxSal").value,r="-"==a[8]?0:1*a[8];return""==n&&""==i||(""==n&&r<=i||(n<=r&&""==i||n<=r&&r<=i))},function(e,a,t){var n=$("#minJobApplication").val(),i=$("#maxJobApplication").val(),r="-"==a[19]?0:1*a[19];return""==n&&""==i||(""==n&&r<=i||(n<=r&&""==i||(n<=r&&r<=i||void 0)))},function(e,a,t){var n=$("#minAge").val(),i=$("#maxAge").val(),r="-"==a[21]?0:1*a[21];return""==n&&""==i||(""==n&&r<=i||(n<=r&&""==i||(n<=r&&r<=i||void 0)))}),$(function(){try{$.ajax({type:"POST",url:"/getAllLanguage",data:!1,async:!1,contentType:!1,processData:!1,success:processLanguage})}catch(e){void 0}NProgress.start();try{$.ajax({type:"POST",url:"/getAllLocality",data:!1,contentType:!1,processData:!1,success:processDataCheckLocality})}catch(e){void 0}try{$.ajax({type:"POST",url:"/getAllJobs",data:!1,contentType:!1,processData:!1,success:processDataCheckJobs})}catch(e){void 0}$("#candidateSearchForm").submit(function(e){e.preventDefault(),searchForm(),shouldAddFooter&&$("#candidateSearchResultTable tfoot th").each(function(){var e=$(this).text();$(this).html('<input type="text" name="'+e+'"  id="'+e+'" placeholder="'+e+'" />')})}),$("#toThisDate").datepicker({dateFormat:"yy-mm-dd",changeYear:!0}),$("#fromThisDate").datepicker({dateFormat:"yy-mm-dd",changeYear:!0})});